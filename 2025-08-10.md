MM-EMBED: UNIVERSAL MULTIMODAL  RETRIEVAL WITH MULTIMODAL LLMS
arXiv 2411.02571
https://huggingface.co/nvidia/MM-Embed

**InfoNCE损失**


---
$$L=− \frac{1}{|B|} \sum_{i=1}^{|B|} \log \frac{\exp (\eta_\theta(inst_i, q_i) \cdot \eta_\theta(c^+_i )/\tau )}{\sum_{c'\in\mathcal{D}} \exp(\eta_\theta(inst_i, q_i) \cdot \eta_\theta(c')/\tau )} , \quad (1)$$

* **分子**：$\exp (\eta_\theta(inst_i, q_i) \cdot \eta_\theta(c^+_i )/\tau )$
    * $\eta_\theta(inst_i, q_i)$ 是查询 $q_i$ 及其指令 $inst_i$ 经过模型编码后的向量表示。
    * $\eta_\theta(c^+_i )$ 是正确的（正样本）候选文档 $c^+_i$ 经过模型编码后的向量表示。
    * $\eta_\theta(inst_i, q_i) \cdot \eta_\theta(c^+_i )$ 是这两个向量的点积，用来衡量它们的**相似度**。点积越大，相似度越高。
    * 这一项代表了**查询与正确文档的相似度**。

* **分母**：$\sum_{c'\in\mathcal{D}} \exp(\eta_\theta(inst_i, q_i) \cdot \eta_\theta(c')/\tau )$
    * $c'$ 代表文档集 $\mathcal{D}$ 中的**所有**候选文档，包括正确的文档和所有不相关的负样本。
    * 这一项代表了**查询与所有文档的相似度之和**。

---
通过提示来对文本到文本检索任务中的候选结果进行重排序，将重排序任务构建为一系列“是/否”（True/False）问题。具体来说，给定一个查询和一个检索到的候选文档，我们提示LLaVa-Next通过回答“True”或“False”来判断该候选文档是否满足查询的要求。为了计算相关性得分，我们对“True”和“False”这两个token的logits应用Softmax操作，并将“True” token的概率作为重排序的相关性得分。
“< qimg >\nCaption:< ctxt >\nDoes the above daily-life image match the caption? True or False”
